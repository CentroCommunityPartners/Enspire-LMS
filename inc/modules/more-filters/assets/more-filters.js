(()=>{"use strict";const e={getParam:function(e){if(void 0!==e)return new URL(window.location.href).searchParams.get(e)},updateParam:function(e,t){if(void 0!==t&&t){t=encodeURI(t);var n=new URL(window.location.href),r=n.searchParams;r.sort(),r.set(e,t),n.search=r.toString(),n=n.toString(),history.pushState("","",n)}},deleteParam:function(e){if(void 0!==e){var t=new URL(window.location.href),n=t.searchParams;n.delete(e),t.search=n.toString(),t=t.toString(),history.pushState("","",t)}},deleteParms:function(){var e=new URL(window.location.href);e.search="",e=e.toString(),history.pushState("","",e)}};function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,l=[],s=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}(e,t)||r(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){s=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(s)throw o}}}}function r(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e){if(e)return e.map((function(e){return{text:e.name,value:e.term_id}}))}var o;window.esConditionalParents={},function(e){e(".esl-field").on("field:toggle",(function(t){!function(t){var r,a,i=n(esfields[t].conditionals);try{for(i.s();!(r=i.n()).done;){var o,l=r.value,s=!0,c=n(l);try{for(c.s();!(o=c.n()).done;){var d=o.value,f=(a=d.name,e('[name="'.concat(a,'"]')).val()),u=!1;switch(d.operator){case"==":u=f==d.value;break;case"!=":u=f!=d.value;break;case"==empty":u=""==f;break;case"!=empty":u=""!=f;break;case"==contains":Array.isArray(f),u=f.includes(d.value)}if(!u){s=!1;break}}}catch(e){c.e(e)}finally{c.f()}if(s)return s}}catch(e){i.e(e)}finally{i.f()}return!1}(e(this).attr("id"))?e(this).trigger("field:hide"):e(this).trigger("field:show")})).on("field:hide",(function(t){var n,r=e(this),a=r.find(".esl-input");a.hasClass("selectize")&&(n=a.data("selectize"))&&(n.clear(),n.disable()),r.hasClass("esl-field-editor")&&(a=r.find("textarea")).html("");var i=a.attr("name");r.addClass("esl-hidden").prop("hidden",!0),a.attr("disabled","disabled"),a.val(""),void 0!==esConditionalParents[i]&&esConditionalParents[i].forEach((function(t){e("#"+t).trigger("field:toggle")}))})).on("field:show",(function(t){var n,r,a=e(this),i=a.find(".esl-input");a.removeClass("esl-hidden").prop("hidden",!1),a.find("[disabled]").removeAttr("disabled"),i.hasClass("selectize")&&((r=(n=i).data("selectize"))?r.enable():n.selectize())}));for(var r=0,a=Object.entries(esfields);r<a.length;r++){var i=t(a[r],2),o=i[0],l=i[1];if(!e.isEmptyObject(l.conditionals)){var s,c=n(l.conditionals);try{for(c.s();!(s=c.n()).done;){var d,f=n(s.value);try{for(f.s();!(d=f.n()).done;){var u=d.value;esConditionalParents.hasOwnProperty(u.name)?esConditionalParents[u.name].includes(o)||esConditionalParents[u.name].push(o):esConditionalParents[u.name]=[o]}}catch(e){f.e(e)}finally{f.f()}}}catch(e){c.e(e)}finally{c.f()}}}for(var h=function(){var r,a=t(m[v],2),i=a[0],o=a[1],l=n(o);try{for(l.s();!(r=l.n()).done;){var s=r.value;e("#"+s).trigger("field:toggle")}}catch(e){l.e(e)}finally{l.f()}e('[name="'.concat(i,'"]')).on("change",(function(){var t,r=n(o);try{for(r.s();!(t=r.n()).done;){var a=t.value;e("#"+a).trigger("field:toggle")}}catch(e){r.e(e)}finally{r.f()}}))},v=0,m=Object.entries(esConditionalParents);v<m.length;v++)h()}(jQuery),function(e){function t(e){var t="";return e&&e.forEach((function(e){t+='<option value="'.concat(e.value,'">').concat(e.text,"</option>")})),t}var n=e(".esl-field:not(.esl-hidden) select.selectize");n.length&&n.selectize(),e(".esl-field-select_hierarchical").on("change","select",(function(){var n=e(this).closest(".esl-field-select_hierarchical"),r=n.attr("id"),a=esfields[r],o=n.find(".esl-subfield"),l=function(e,t){function n(e,t){for(var r=0;r<e.length;r++){var a=e[r];if(a.term_id==t)return a;if(null!=a&&a.children){var i=n(a.children,t);if(i)return i}}}for(var r=0;r<e.length;r++){var a=e[r];if(a.term_id==t)return a;if(null!=a&&a.children){var i=n(a.children,t);if(i)return i}}}(a.categories,e(this).val()),s=e(this).closest(".esl-subfield"),c=s.index();"static"==a.render_type&&(o.each((function(){e(this).index()>c&&function(t){t.prop("disabled",!0),t.find("option:not(.option-placeholder)").remove(),function(e){var t=e.data("selectize");t&&(t.clear(),t.clearOptions(),t.disable())}(e(this))}(e(this).find("select"))})),null!=l&&l.children&&function(n,r){var a=i(r),o=t(a);n.prop("disabled",!1),n.append(o),function(e,t){var n=e.data("selectize");n&&(n.addOption(t),n.enable(),n.refreshOptions())}(e(this),a)}(s.next().find("select"),l.children));if("dynamic"==a.render_type){o.each((function(){e(this).index()>c&&e(this).remove()}));var d=function(e,n,r){var a,o=null!==(a=null==e?void 0:e.group_label)&&void 0!==a?a:"Child ".concat(r),l=i(null==e?void 0:e.children);if(l)return l=t(l),'\n    <div class="esl-subfield esl-subfield-'.concat(r,'">\n      <label for="esl-field-').concat(n.id,"-").concat(r,'">').concat(o,'</label>\n      <select id="esl-field-').concat(n.id,"-").concat(r,'" name="taxonomy-').concat(n.taxonomy,'" class="esl-input esl-input-').concat(n.type,'" data-taxonomy="').concat(n.taxonomy,'">\n      <option value="" selected="" class="option-placeholder">Choose option</option>\n      ').concat(l,"\n      </select>\n    </div>")}(l,a,c+1);if(d){n.append(d);var f=n.find("select:not(.selectized)");f.length&&f.selectize()}}}))}(jQuery),(o=jQuery)(".morefilters").each((function(){o(this);var t=o(this).find(".ensp-ajax-content"),n=(o(this).find(".ensp-ajax-filters"),o(this).find(".esl-form")),r=o(this).find(".ensp-ajax-items"),a=(o(this).find(".ensp-filter"),o(this).find(".button-loadmore")),i=o(this).find('button[type="submit"]'),l=o(this).find('button[type="reset"]'),s=t.data("store");function c(){s.paged>=s.max_pages||0==s.max_pages?a.addClass("disabled").hide():a.removeClass("disabled").show()}function d(){var e,t;e=n.serializeArray(),t=!0,e.forEach((function(e){e.value&&(t=!1)})),t?l.addClass("disabled").hide():l.removeClass("disabled").show()}function f(){t.data("store",s)}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"loadmore";o.ajax({url:ajaxurl.ajaxurl,data:{action:"more_filters",store:s,context:e},type:"POST",beforeSend:function(){console.log(s),"refresh"==e&&t.addClass("loading-big"),a.addClass("disabled").text("Loading...")},success:function(n){console.log(n),"refresh"==e&&t.removeClass("loading-big"),a.text("Load More"),n?(n.error&&console.log(n.error),"refresh"==e&&r.html(""),r.append(n.posts),s.paged=n.paged,s.max_pages=n.max_pages,f(),c()):console.log("No response")}}),d()}d(),a.click((function(e){e.preventDefault(),u("loadmore")})),l.click((function(t){var r;t.preventDefault(),s.taxonomies=[],s.meta=[],s.search="",f(),u("refresh"),e.deleteParms(),(r=n).trigger("reset"),r.find("input:text, input:password, input:file").val("").removeAttr("value"),r.find("textarea").val("").html(""),r.find("input:radio, input:checkbox").removeAttr("checked").removeAttr("selected"),r.find("select").val("").find("option:selected").removeAttr("selected"),d()})),i.length||(n.on("change",".esl-input",(function(t){var n;t.preventDefault();var r=o(this).attr("name"),a=o(this).val(),i=function(e){var t={};return Object.entries(window.esfields).forEach((function(n){n[1].name!=e||(t=n[1])})),t}(r),l=null!==(n=null==i?void 0:i.slug)&&void 0!==n?n:"",c="taxonomy-"==r.substring(0,9)?r.slice(9):"";a?e.updateParam(l,a):e.deleteParam(l),c?function(e,t){if(e){var n=Array.isArray(t)?t:[t],r=void 0;s.taxonomies.forEach((function(t,n){t.taxonomy!=e||(r=n)})),null!=r&&t.length&&(s.taxonomies[r].terms=n),null==r||t.length||(s.taxonomies=s.taxonomies.filter((function(e,t){return r!=t}))),null==r&&t.length&&s.taxonomies.push({taxonomy:e,terms:n}),f()}}(c,a):"search"==r&&function(e){s.search=e,f()}(a),u("refresh")})),n.submit((function(e){return e.preventDefault()})))}))})();